<!DOCTYPE html>
<html>
    <head>
        <title> Assignment 1</title>
        <!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">

<!-- jQuery library -->
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>

<!-- Popper JS -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>


</head>
<body>

<h1>Assignment 1</h1>

<p></p>
<div id = "main" class="mx-5"> 
<p id="update"></p>
<table id="lots" border="1" class="table">
    <thead class="thead-dark">
        <tr>
            <th>Metrics</th>
            <th>National</th>
            <th>Central</th>
            <th>West</th>
            <th>East</th>
            <th>North</th>
            <th>South</th>
        </tr>
    </thead>
    <tbody>

    </tbody>
    
</table>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
    
let myData = {};
console.log("testing");
fetch('https://api.data.gov.sg/v1/environment/psi')
    .then(response => response.json())
    .then(data => {
        myData = data;
        console.log(myData);
        sortData(myData);
    }); 

    
function sortData(data) {
    var out = '', datetime, datetimeout;

    console.log(data.items[0].update_timestamp);
    datetime = (data.items[0].update_timestamp).split("T");
    document.getElementById("update").innerHTML = datetime[1]; 

    total = Object.keys(data.items[0].readings).length;
    console.log(total);
    
    for (const [key, value] of Object.entries(data.items[0].readings)) {
        console.log(key);
        console.log(value);
        console.log(value["west"]);
        out += "<tr><td>"
            + key + "</td><td>"
            + value["national"] + "</td><td>"
            + value["central"] + "</td><td>"
            + value["west"] + "</td><td>"
            + value["east"] + "</td><td>"
            + value["north"] + "</td><td>"
            + value["south"]+ "</td>"
            + "</tr>"
    }

    $('tbody').append(out);

}

</script>

</body>
</html>